import{l as v,h as O,x as z,m as E,o as l,f as s,b as e,a as x,w as y,y as p,z as M,g as c,n as N,t as o,c as V,d as _,F as S,p as D,q as F,s as H}from"./app-d9f75028.js";import R from"./DrawPlayerBracket-8589042d.js";import B from"./DrawRrb-071585f0.js";import"./lodash-ddff52aa.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./Chart-7d9f2f2d.js";import"./Athlete-a34bbeaf.js";import"./AthleteSm-33d97679.js";const m={EMPTY:"empty",GROUP_NAME:"groupName",NAME_LIST:"nameList",DRAW:"draw"},j={components:{Player:R,DrawRrb:B},provide(){return{language:this.language,competition:this.competition}},mounted(){this.interval=setInterval(()=>{this.language=(this.language+1)%2},5e3)},deactivated(){clearInterval(this.interval)},data(){return{interval:null,language:0,audioSource:"/assets/draw-music.mp3",audioElement:null,playingAudio:!1}},setup(){const u=new BroadcastChannel("draw"),d=v(m.EMPTY),t=v(null),a=v(null),f=v(new Date),r=v(0),g=8,b=3e3,i=O(()=>{if(d.value===m.NAME_LIST){const n=r.value*g;return t.value.athletes.slice(n,n+g)}}),I=()=>{if((1+r.value)*g>=t.value.athletes.length){r.value=0;return}++r.value},L=(n,w)=>{const k={8:[1,5,7,3,4,8,6,2],16:[1,9,13,5,7,15,11,3,4,12,16,8,6,14,10,2],32:[1,17,25,9,13,21,29,5,7,19,27,11,3,15,23,31,4,20,28,12,16,24,32,8,6,18,26,10,14,22,30,2],64:[1,33,49,17,25,41,57,9,13,37,53,21,29,45,61,5,7,35,51,19,27,43,59,11,3,31,47,15,23,39,55,63,4,32,48,20,28,44,60,12,16,36,52,24,32,48,64,8,6,34,50,18,26,42,58,10,14,38,54,22,30,46,62,2]},P=n.filter(h=>h.seed).sort((h,T)=>k[w].indexOf(T.seed)-k[w].indexOf(h.seed));console.debug("seeded athlete",P);const C=n.filter(h=>!h.seed);return console.debug("other athlete",C),[...P,...C]};return z(d,(n,w)=>{switch(r.value=0,clearInterval(a.value),n){case m.NAME_LIST:a.value=setInterval(I,b)}}),u.postMessage({message:"pong"}),u.onmessage=n=>{switch(console.debug(n),console.log(JSON.parse(n.data.payload)),n.data.message){case"ping":u.postMessage({message:"pong"});return;case"close":window.close();return;case"showGroupName":d.value=m.GROUP_NAME,t.value=JSON.parse(n.data.payload);return;case"showNameList":r.value=0,t.value=JSON.parse(n.data.payload),d.value=m.NAME_LIST;return;case"draw":t.value=JSON.parse(n.data.payload),t.value.program.contest_system!=="rrb"&&(t.value.athletes=L(t.value.athletes,t.value.program.chart_size)),console.log("stagePayload.value.athletes",t.value.athletes),d.value=m.DRAW;return;case"showCover":t.value=null,d.value=m.EMPTY;return}f.value=new Date},window.addEventListener("beforeunload",()=>{u.postMessage({message:"disconnect"})}),{bc:u,lastAction:f,Stage:m,currentStage:d,stagePayload:t,nameListSlice:i}},props:{competition:{type:Object,required:!0},draw:{type:Object,required:!0}},mounted(){this.audioElement=this.$refs.audioPlayer},methods:{playAudio(){this.playingAudio=!0,this.audioElement.play()},stopAudio(){this.playingAudio=!1,this.audioElement.pause(),this.audioElement.currentTime=0}}},A=u=>(F("data-v-175bcba5"),u=u(),H(),u),J={ref:"audioPlayer",src:"/assets/draw-music.mp3",loop:""},U={class:"flex justify-end p-2 mx-2"},Y=A(()=>e("svg",{fill:"#000000",width:"20px",height:"20px",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10 2c3.314 0 6 2.693 6 6 0 3.314-2.693 6-6 6v-2c2.205 0 4-1.79 4-4 0-2.205-1.79-4-4-4V2zm0 4c1.105 0 2 .888 2 2 0 1.105-.888 2-2 2V6zM0 3h2l6-3v16l-6-3H0V3zm2 2v6l4 2V3L2 5z","fill-rule":"evenodd"})],-1)),Z=[Y],q=A(()=>e("svg",{width:"20px",height:"20px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 5C10 3.34315 8.65686 2 7 2H5C3.34315 2 2 3.34315 2 5V19C2 20.6569 3.34315 22 5 22H7C8.65686 22 10 20.6569 10 19V5ZM8 5C8 4.44772 7.55229 4 7 4H5C4.44772 4 4 4.44772 4 5V19C4 19.5523 4.44772 20 5 20H7C7.55229 20 8 19.5523 8 19V5Z",fill:"#0F0F0F"}),e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M22 5C22 3.34315 20.6569 2 19 2H17C15.3431 2 14 3.34315 14 5V19C14 20.6569 15.3431 22 17 22H19C20.6569 22 22 20.6569 22 19V5ZM20 5C20 4.44772 19.5523 4 19 4H17C16.4477 4 16 4.44772 16 5V19C16 19.5523 16.4477 20 17 20H19C19.5523 20 20 19.5523 20 19V5Z",fill:"#0F0F0F"})],-1)),W=[q],K={key:0,class:"p-16 flex flex-col"},Q={class:"flex bg-white/75 rounded-lg items-center p-4 backdrop-blur"},X={key:0},$=["src"],ee={class:"text-4xl font-extrabold mb-2"},te={key:0,class:"text-4xl font-extrabold mb-0"},ae={class:"text-right"},oe={class:"text-4xl font-bold mb-2"},le={class:"text-4xl font-medium mb-0"},se={class:"w-full justify-center flex-1 relative overflow-hidden mt-16"},ne={key:0,class:"flex items-center p-16"},ie={class:"text-7xl font-bold leading-relaxed m-0"},de={class:"text-4xl font-medium leading-relaxed m-0"},re={class:"text-3xl text-gray-800 font-medium leading-relaxed m-0"},ce={class:"font-bold"},ue={key:0,class:"flex p-16 flex-col justify-start"},me={class:"flex bg-white/75 rounded-lg items-center p-4 backdrop-blur"},_e={key:0},ge=["src"],he={class:"text-4xl font-extrabold mb-2"},ve={key:0,class:"text-4xl font-extrabold mb-0"},fe={class:"text-right"},xe={class:"text-4xl font-bold mb-2"},ye={class:"text-4xl font-medium mb-0"},pe={class:"flex-1"},be={class:"mt-16 grid grid-cols-2 w-full gap-6"},we={class:"text-4xl font-bold mb-2"},Se={key:0,class:"absolute bg-yellow-500 rotate-45 h-16 w-16 -right-8 -top-8 transform"},Ae={class:"text-4xl font-medium"},ke=A(()=>e("div",{class:"flex gap-4 text-3xl font-bold items-center mt-16"},[e("span",{class:"inline-block bg-yellow-500 rounded-full w-8 h-8"}),_(" 種子選手 / Atleta Semente / Seeded Athlete ")],-1));function Pe(u,d,t,a,f,r){const g=E("player"),b=E("draw-rrb");return l(),s("div",{class:"w-screen h-screen bg-slate-300 fixed",style:M(`background-image: url('${t.draw.background}'); background-size: cover`)},[e("audio",J,null,512),e("div",U,[f.playingAudio?(l(),s("button",{key:1,onClick:d[1]||(d[1]=(...i)=>r.stopAudio&&r.stopAudio(...i)),class:"text-right"},W)):(l(),s("button",{key:0,onClick:d[0]||(d[0]=(...i)=>r.playAudio&&r.playAudio(...i)),class:"text-right"},Z))]),x(p,null,{default:y(()=>[a.currentStage===a.Stage.EMPTY?(l(),s("div",{key:0,class:"w-full h-full",style:M(`background-image: url('${t.draw.cover}'); background-size: cover;`)},null,4)):c("",!0)]),_:1}),x(p,null,{default:y(()=>[a.currentStage===a.Stage.DRAW?(l(),s("div",K,[e("div",Q,[t.competition.logo_url!=""?(l(),s("div",X,[e("img",{src:t.competition.logo_url,class:"h-24 w-auto"},null,8,$)])):c("",!0),e("div",{class:N(["flex-1 text-neutral-800 flex flex-col",{"ml-12":t.competition.logo_url!==""}])},[e("h1",ee,o(t.competition.name),1),t.competition.is_language_secondary_enabled?(l(),s("h1",te,o(t.competition.name_secondary),1)):c("",!0)],2),e("div",ae,[e("h2",oe,o(a.stagePayload.program.competition_category.name)+" "+o(a.stagePayload.program.name),1),e("h3",le," 共 "+o(a.stagePayload.athletes.length)+" 人 ",1)])]),e("div",se,[a.stagePayload.program.contest_system!=="rrb"?(l(),V(g,{athletes:a.stagePayload.athletes,key:a.lastAction},null,8,["athletes"])):(l(),V(b,{athletes:a.stagePayload.athletes,key:a.lastAction},null,8,["athletes"]))])])):c("",!0)]),_:1}),x(p,null,{default:y(()=>[a.currentStage===a.Stage.GROUP_NAME?(l(),s("div",ne,[e("div",null,[e("h2",ie,o(a.stagePayload.program.competition_category.name)+" "+o(a.stagePayload.program.name),1),e("h2",de,o(a.stagePayload.program.weight_code),1),e("h3",re,[_(" 共 "),e("span",ce,o(a.stagePayload.athletes.length),1),_(" 人 ")])])])):c("",!0)]),_:1}),x(p,null,{default:y(()=>[a.currentStage===a.Stage.NAME_LIST?(l(),s("div",ue,[e("div",me,[t.competition.logo_url!=""?(l(),s("div",_e,[e("img",{src:t.competition.logo_url,class:"h-24 w-auto"},null,8,ge)])):c("",!0),e("div",{class:N(["flex-1 text-neutral-800 flex flex-col",{"ml-12":t.competition.logo_url!==""}])},[e("h1",he,o(t.competition.name),1),t.competition.is_language_secondary_enabled?(l(),s("h1",ve,o(t.competition.name_secondary),1)):c("",!0)],2),e("div",fe,[e("h2",xe,o(a.stagePayload.program.competition_category.name)+o(a.stagePayload.program.weight_code),1),e("h3",ye," 共 "+o(a.stagePayload.athletes.length)+" 人 ",1)])]),e("div",pe,[e("div",be,[(l(!0),s(S,null,D(a.nameListSlice,i=>(l(),s("div",{key:i.id,class:"rounded-lg bg-white/75 overflow-clip p-4 relative backdrop-blur"},[e("div",we,[i.seed?(l(),s("div",Se)):c("",!0),_(" "+o(i.name_zh)+" ",1),e("span",null,[t.competition.is_language_secondary_enabled?(l(),s(S,{key:0},[_(o(i.name_pt),1)],64)):c("",!0)])]),e("div",Ae,[e("span",null,o(i.team.abbreviation),1),_(" - "+o(i.team.name_zh)+" ",1),t.competition.is_language_secondary_enabled?(l(),s(S,{key:0},[_(" - "+o(i.team.name_pt),1)],64)):c("",!0)])]))),128))])]),ke])):c("",!0)]),_:1})],4)}const Oe=G(j,[["render",Pe],["__scopeId","data-v-175bcba5"]]);export{Oe as default};
