import{P as M}from"./ProgramLayout-1d440752.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import{R as F,E as Q,S as T,U as j,V as D,M as R,m as o,o as e,c as m,w as a,a as n,f as r,b as u,F as f,p as q,d,t as p,g as y}from"./app-d9f75028.js";import{M as z}from"./MoreOutlined-36102af1.js";import"./judoka-logo-eef90ab5.js";import"./VideoCameraOutlined-6422ac09.js";const G={name:"Weights",components:{ProgramLayout:M,MoreOutlined:z,CheckCircleOutlined:F,CloseCircleOutlined:Q,CheckOutlined:T,CloseOutlined:j,QuestionCircleOutlined:D},props:["competition"],data(){return{categoryId:null,programId:null,programs:[],program:{},athletes:[],columns:[{key:"name_display",title:"Athletes",dataIndex:"name_display"},{key:"result",title:"Weigh-in result",dataIndex:"result",width:150},{key:"program",title:"Program"},{key:"weight",title:"Weight",dataIndex:"weight",align:"right"}]}},methods:{onChangeCategory(i){this.programs=this.competition.programs_athletes.filter(s=>s.competition_category_id==i.target.value),console.log(i.target.value)},onChangeProgram(i){this.program=this.competition.programs_athletes.find(s=>s.id==i)},passWeight(i){if(i.pivot.weight===null){this.$message.error("過磅重量未錄入");return}this.$inertia.post(route("manage.competition.programAthlete.weightChecked",{weight:i.pivot.weight,competition:this.competition.id,programAthlete:i.id}),null,{preserveScroll:!0,onSuccess:s=>{this.$message.success("已確定"),this.onChangeProgram(this.programId)},onError:s=>{this.$message.error(s.response.data.message)}})},confirmAllWeight(){R.confirm({title:"確認過磅",content:"確認過磅後，將無法再修改過磅結果",okText:"確認",cancelText:"取消",onOk:()=>{window.axios.post(route("manage.competition.athletes.weights.lock",{competition:this.competition.id,program:this.program.id})).then(()=>{this.$message.success("過磅已確認"),this.$inertia.reload()}).catch(i=>{this.$message.error(i.response.data.message)})}})}}},H={key:0,class:"mx-6 flex flex-col gap-3"},J={class:"bg-white p-2 rounded-md shadow-md"},K=u("div",{class:"text-xl font-bold mb-4"},"Weight Choose",-1),X={key:0},Y={key:2},Z={key:1},$={key:2,class:"flex gap-3 justify-end"},ee={key:0,class:"font-bold flex gap-1 items-center"},te={key:1,class:"font-bold"},oe={key:1,class:"p-6"},ae=u("h3",{class:"font-bold text-lg"},"Not draw",-1),ne=u("p",null,"draw not finish",-1);function ie(i,s,g,se,l,_){const v=o("a-page-header"),w=o("a-radio-button"),x=o("a-radio-group"),k=o("a-form-item"),b=o("a-select"),I=o("a-form"),h=o("a-button"),O=o("CheckCircleOutlined"),P=o("CloseCircleOutlined"),W=o("QuestionCircleOutlined"),N=o("a-input-number"),S=o("CheckOutlined"),A=o("a-table"),U=o("inertia-link"),V=o("a-empty"),B=o("a-card"),L=o("ProgramLayout");return e(),m(L,{competitionId:g.competition.id},{default:a(()=>[n(v,{title:"Weigh-in"}),g.competition.status>=3?(e(),r("div",H,[u("div",J,[K,n(I,null,{default:a(()=>[n(k,{label:"Category",name:"category"},{default:a(()=>[n(x,{value:l.categoryId,"onUpdate:value":s[0]||(s[0]=t=>l.categoryId=t),"button-style":"solid",onChange:_.onChangeCategory},{default:a(()=>[(e(!0),r(f,null,q(g.competition.categories,t=>(e(),m(w,{key:t,value:t.id},{default:a(()=>[d(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1}),n(k,{label:"Program",name:"program"},{default:a(()=>[n(b,{options:l.programs,value:l.programId,"onUpdate:value":s[1]||(s[1]=t=>l.programId=t),fieldNames:{value:"id",label:"weight_code"},onChange:_.onChangeProgram},null,8,["options","value","onChange"])]),_:1})]),_:1})]),l.program.athletes!=null?(e(),r("div",X,[this.program.athletes.find(t=>t.pivot.confirm==0&&t.pivot.is_weight_passed==null)!=null?(e(),m(h,{key:0,type:"link"},{default:a(()=>[d(" Program athletes not weighed ")]),_:1})):this.program.athletes.find(t=>t.pivot.confirm==1)==null?(e(),m(h,{key:1,type:"primary",class:"bg-blue-500",onClick:_.confirmAllWeight},{default:a(()=>[d(" Finish weigh-in ")]),_:1},8,["onClick"])):(e(),r("span",Y,"Program athletes weighed"))])):y("",!0),n(A,{dataSource:l.program.athletes,columns:l.columns},{bodyCell:a(({column:t,record:c})=>[t.dataIndex==="result"?(e(),r(f,{key:0},[c.pivot.is_weight_passed==1?(e(),m(O,{key:0,class:"!text-green-800 dark:!text-green-400"})):c.pivot.is_weight_passed==0?(e(),m(P,{key:1,class:"!text-red-800 dark:!text-red-400"})):(e(),m(W,{key:2}))],64)):y("",!0),t.key==="program"?(e(),r("span",Z,p(l.program.weight_code)+" "+p(l.program.competition_category.name),1)):t.dataIndex==="weight"?(e(),r("div",$,[c.confirmed?(e(),r("span",te,p(c.pivot.weight)+" kg ",1)):(e(),r("div",ee,[n(N,{value:c.pivot.weight,"onUpdate:value":C=>c.pivot.weight=C,"default-value":0,name:"weight",min:0,max:999,precision:2,step:.01},null,8,["value","onUpdate:value"]),d("kg ")])),c.confirmed?y("",!0):(e(),m(h,{key:2,onClick:C=>_.passWeight(c),name:"pass",shape:"circle"},{icon:a(()=>[n(S)]),_:2},1032,["onClick"]))])):(e(),r(f,{key:3},[d(p(c[t.dataIndex]),1)],64))]),_:1},8,["dataSource","columns"])])):(e(),r("div",oe,[n(B,null,{default:a(()=>[n(V,null,{description:a(()=>[ae,ne,n(U,{href:i.route("manage.competition.athletes.drawControl",g.competition.id)},{default:a(()=>[n(h,{type:"primary",class:"bg-blue-500"},{default:a(()=>[d(" go to athletes draw ")]),_:1})]),_:1},8,["href"])]),_:1})]),_:1})]))]),_:1},8,["competitionId"])}const ge=E(G,[["render",ie]]);export{ge as default};
